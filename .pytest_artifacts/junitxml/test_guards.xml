<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="5" skipped="0" tests="12" time="5.789" timestamp="2026-02-16T16:51:17.138065+01:00" hostname="LAPTOP-4UQ2EECE"><testcase classname="tests.unit.test_guards" name="test_guard_natural_suffix_requires_number_on_drops" time="2.890" /><testcase classname="tests.unit.test_guards" name="test_guard_natural_suffix_requires_number_off_keeps" time="0.034"><failure message="AssertionError: With guard OFF and other guards disabled, 'Am Wald' may be kept as ADDRESS.&#10;assert '&lt;ADDRESS&gt;' in 'Am Wald'">f = &lt;PII_filter.pii_filter.PIIFilter object at 0x000001404430CF10&gt;

    def test_guard_natural_suffix_requires_number_off_keeps(f):
        text = "Am Wald"
        out = f.anonymize_text(
            text,
            guards_enabled=True,
            guard_natural_suffix_requires_number=False,   # OFF
            guard_single_token_addresses=False,
            guard_address_vs_person_priority=False,
            guard_requires_context_without_number=False,
        )
        # With other guards off, permissive regex may keep it
&gt;       assert "&lt;ADDRESS&gt;" in out, "With guard OFF and other guards disabled, 'Am Wald' may be kept as ADDRESS."
E       AssertionError: With guard OFF and other guards disabled, 'Am Wald' may be kept as ADDRESS.
E       assert '&lt;ADDRESS&gt;' in 'Am Wald'

tests\unit\test_guards.py:38: AssertionError</failure></testcase><testcase classname="tests.unit.test_guards" name="test_guard_requires_context_without_number_drops_without_keyword" time="0.024" /><testcase classname="tests.unit.test_guards" name="test_guard_requires_context_without_number_kept_with_keyword" time="0.018"><failure message="AssertionError: Context keyword + no number → allowed by the guard.&#10;assert '&lt;ADDRESS&gt;' in 'My address is Rue Victor Hugo'">f = &lt;PII_filter.pii_filter.PIIFilter object at 0x000001404430CF10&gt;

    def test_guard_requires_context_without_number_kept_with_keyword(f):
        text = "My address is Rue Victor Hugo"   # 'address' is in ADDRESS_CONTEXT_KEYWORDS
        out = f.anonymize_text(
            text,
            guards_enabled=True,
            guard_requires_context_without_number=True,   # ON
            guard_natural_suffix_requires_number=False,
            guard_single_token_addresses=False,
            guard_address_vs_person_priority=False,
        )
&gt;       assert "&lt;ADDRESS&gt;" in out, "Context keyword + no number → allowed by the guard."
E       AssertionError: Context keyword + no number → allowed by the guard.
E       assert '&lt;ADDRESS&gt;' in 'My address is Rue Victor Hugo'

tests\unit\test_guards.py:67: AssertionError</failure></testcase><testcase classname="tests.unit.test_guards" name="test_guard_requires_context_without_number_off_kept" time="0.023"><failure message="AssertionError: With guard OFF, name-only street can be kept.&#10;assert '&lt;ADDRESS&gt;' in 'Rue Victor Hugo'">f = &lt;PII_filter.pii_filter.PIIFilter object at 0x000001404430CF10&gt;

    def test_guard_requires_context_without_number_off_kept(f):
        text = "Rue Victor Hugo"
        out = f.anonymize_text(
            text,
            guards_enabled=True,
            guard_requires_context_without_number=False,  # OFF
            guard_natural_suffix_requires_number=False,
            guard_single_token_addresses=False,
            guard_address_vs_person_priority=False,
        )
&gt;       assert "&lt;ADDRESS&gt;" in out, "With guard OFF, name-only street can be kept."
E       AssertionError: With guard OFF, name-only street can be kept.
E       assert '&lt;ADDRESS&gt;' in 'Rue Victor Hugo'

tests\unit\test_guards.py:80: AssertionError</failure></testcase><testcase classname="tests.unit.test_guards" name="test_guard_single_token_addresses_on_drops" time="0.012" /><testcase classname="tests.unit.test_guards" name="test_guard_single_token_addresses_off_keeps" time="0.011"><failure message="AssertionError: With guard OFF, permissive suffix match can be kept as ADDRESS.&#10;assert '&lt;ADDRESS&gt;' in 'Rosenweg'">f = &lt;PII_filter.pii_filter.PIIFilter object at 0x000001404430CF10&gt;

    def test_guard_single_token_addresses_off_keeps(f):
        text = "Rosenweg"
        out = f.anonymize_text(
            text,
            guards_enabled=True,
            guard_single_token_addresses=False,           # OFF
            guard_requires_context_without_number=False,
            guard_natural_suffix_requires_number=False,
            guard_address_vs_person_priority=False,
        )
&gt;       assert "&lt;ADDRESS&gt;" in out, "With guard OFF, permissive suffix match can be kept as ADDRESS."
E       AssertionError: With guard OFF, permissive suffix match can be kept as ADDRESS.
E       assert '&lt;ADDRESS&gt;' in 'Rosenweg'

tests\unit\test_guards.py:109: AssertionError</failure></testcase><testcase classname="tests.unit.test_guards" name="test_location_dropped_when_followed_by_tax_label" time="0.015" /><testcase classname="tests.unit.test_guards" name="test_location_dropped_when_preceded_by_id_label" time="0.020" /><testcase classname="tests.unit.test_guards" name="test_demote_phone_overlapping_with_date" time="0.014" /><testcase classname="tests.unit.test_guards" name="test_promote_meeting_over_phone" time="0.016" /><testcase classname="tests.unit.test_guards" name="test_trim_address_span_at_newline_or_label" time="0.165"><failure message="AssertionError: assert '&lt;EMAIL&gt;' in '&lt;ADDRESS&gt;\nemail: juan@example.com'">f = &lt;PII_filter.pii_filter.PIIFilter object at 0x000001404430CF10&gt;

    def test_trim_address_span_at_newline_or_label(f):
        text = "Calle Mayor 5\nemail: juan@example.com"
        out = f.anonymize_text(text, guards_enabled=True)
        # Address should be trimmed before email label (and email anonymized)
        assert "&lt;ADDRESS&gt;" in out
&gt;       assert "&lt;EMAIL&gt;" in out
E       AssertionError: assert '&lt;EMAIL&gt;' in '&lt;ADDRESS&gt;\nemail: juan@example.com'

tests\unit\test_guards.py:162: AssertionError</failure></testcase></testsuite></testsuites>