<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="6" skipped="0" tests="191" time="43.522" timestamp="2026-02-16T16:55:58.668476+01:00" hostname="LAPTOP-4UQ2EECE"><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[123 Main Street]" time="2.375" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[Hauptstra\xdfe 5]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[Rue de la Paix 12]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[Calle Mayor 10]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[Fatih mahallesi No:25]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_regex_positive[\u0634\u0627\u0631\u0639 \u0627\u0644\u0645\u0644\u0643 \u0641\u064a\u0635\u0644 20]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_pipeline_negative_with_guards[Random text without patterns]" time="0.556" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_pipeline_negative_with_guards[Company policy document]" time="0.019" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_pipeline_negative_with_guards[John likes pizza on weekends]" time="0.033" /><testcase classname="tests.unit.test_regex_patterns" name="test_address_pipeline_negative_with_guards[Lorem ipsum dolor sit amet]" time="0.020" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[10115 Berlin]" time="0.003" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[75008 Paris]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[28013 Madrid]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[00144 Roma]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[W1A 1AA]" time="0.031" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_regex_positive[75008 PARIS]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_pipeline_negative_with_guards[A1B 2C3 Toronto]" time="0.019" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_pipeline_negative_with_guards[90210-1234 Beverly Hills]" time="0.015" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_pipeline_negative_with_guards[150-0001 Tokyo]" time="0.016" /><testcase classname="tests.unit.test_regex_patterns" name="test_postal_pipeline_negative_with_guards[01001-000 S\xe3o Paulo]" time="0.009" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_positive[+49 151 23456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_positive[+1 (555) 123-4567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_positive[0555-1234567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_positive[+971 55 123 4567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_negative[12345]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_negative[abc-def-ghij]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_phone_regex_negative[room 123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_positive[12/10/2023]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_positive[12-10-2023]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_positive[2023-10-12]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_positive[12 October 2023]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_positive[12 Okt 2023]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_negative[123456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_negative[yesterday]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_date_regex_negative[12/2023]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_health_info_positive[Diagnosed with diabetes]" time="0.015" /><testcase classname="tests.unit.test_regex_patterns" name="test_health_info_positive[Blood type: O+]" time="0.014" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Amtsgericht M\xfcnchen, Handelsregister B 123456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Registergericht Dresden, Abteilung B, HRB 234567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Das Unternehmen ist eingetragen im Handelsregister beim Amtsgericht M\xfcnchen, Abteilung B, HRA 345678.]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Tribunal de Commerce Paris, Registre B 567890]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[RCS Paris B 678901]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Registro Mercantil Madrid, Secci\xf3n B 890123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Reg. Merc. Barcelona, Secc. A 901234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[La sociedad est\xe1 inscrita en el Registro Mercantil de Madrid, secci\xf3n B, n\xfamero 012345.]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Registro delle Imprese Roma, Sezione B 123456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[REA Roma 234567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[L'impresa \xe8 iscritta nel Registro delle Imprese di Roma, sezione B, numero 345678.]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Handelsregister Amsterdam, Afdeling B 456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[KVK Amsterdam 567890]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_positive[Het bedrijf staat ingeschreven in het Handelsregister van Amsterdam, afdeling B, nummer 678901.]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_negative[Random business text]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_negative[Company ABC 123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_negative[Division B of the company]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_negative[12345678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_regex_negative[Paris Section B]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[Amtsgericht M\xfcnchen, Handelsregister B 123456-&lt;COMMERCIAL_REGISTER&gt;]" time="0.014" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[Registergericht Dresden, Abteilung B, HRB 234567-&lt;COMMERCIAL_REGISTER&gt;]" time="0.011" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[RCS Paris B 678901-&lt;COMMERCIAL_REGISTER&gt;]" time="0.035" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[Registro Mercantil Madrid, Secci\xf3n B 890123-&lt;COMMERCIAL_REGISTER&gt;]" time="0.013" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[Registro delle Imprese Roma, Sezione B 123456-&lt;COMMERCIAL_REGISTER&gt;]" time="0.013" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_anonymization[Handelsregister Amsterdam, Afdeling B 456789-&lt;COMMERCIAL_REGISTER&gt;]" time="0.027" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_german_court_variants" time="2.103" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_language_coverage" time="2.129" /><testcase classname="tests.unit.test_regex_patterns" name="test_commercial_register_with_context" time="2.231"><failure message="AssertionError: Should also detect email&#10;assert '&lt;EMAIL&gt;' in '\n    Company Registration &lt;LICENSE_PLATE&gt;:\n    The company is registered at:\n    - &lt;COMMERCIAL_REGISTER&gt;123456\n    - German VAT ID: &lt;TAX_ID&gt;\n    - Contact: &lt;EMAIL_ADDRESS&gt;\n    '">def test_commercial_register_with_context():
        """Test COMMERCIAL_REGISTER detection in realistic document context."""
        f = PIIFilter()
    
        document = """
        Company Registration Details:
        The company is registered at:
        - Amtsgericht München, Handelsregister B 123456
        - German VAT ID: DE123456789
        - Contact: max.mustermann@example.de
        """
    
        out = f.anonymize_text(document)
        assert "&lt;COMMERCIAL_REGISTER&gt;" in out, "Should detect commercial register in document"
&gt;       assert "&lt;EMAIL&gt;" in out, "Should also detect email"
E       AssertionError: Should also detect email
E       assert '&lt;EMAIL&gt;' in '\n    Company Registration &lt;LICENSE_PLATE&gt;:\n    The company is registered at:\n    - &lt;COMMERCIAL_REGISTER&gt;123456\n    - German VAT ID: &lt;TAX_ID&gt;\n    - Contact: &lt;EMAIL_ADDRESS&gt;\n    '

tests\unit\test_regex_patterns.py:237: AssertionError</failure></testcase><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Case ID: CASE-2023-001234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Reference Number: REF-2024-567890]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Ticket ID: TKT-2024-999]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Customer Number: CUST-2023-55555]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Aktenzeichen: AZ-2023-123456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Vorgangsnummer: VN-2024-789012]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Kundennummer: KN-2023-456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Num\xe9ro de dossier: ND-2024-001]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Dossier #DOSS-2023-999]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[N\xfamero de expediente: EXP-2023-999]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Expediente #EXP-2024-111]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Numero pratica: PR-2024-555]" time="0.003" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Pratica #PRT-2023-222]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Dosya numaras\u0131: DN-2023-777]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[Dosya #DOS-2024-333]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[\u0631\u0642\u0645 \u0627\u0644\u0642\u0636\u064a\u0629: RQ-2024-333]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_positive[\u0631\u0642\u0645 \u0627\u0644\u0642\u0636\u064a\u0629 #RQ-2023-444]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_negative[Random case text]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_negative[123456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_negative[case of the missing letter]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_negative[reference book]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_regex_negative[ticket sales event]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Case ID: CASE-2023-001234-&lt;CASE_REFERENCE&gt;]" time="0.029" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Reference Number: REF-2024-567890-&lt;CASE_REFERENCE&gt;]" time="0.033" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Aktenzeichen: AZ-2023-123456-&lt;CASE_REFERENCE&gt;]" time="0.011" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Num\xe9ro de dossier: ND-2024-001-&lt;CASE_REFERENCE&gt;]" time="0.013" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[N\xfamero de expediente: EXP-2023-999-&lt;CASE_REFERENCE&gt;]" time="0.015" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Numero pratica: PR-2024-555-&lt;CASE_REFERENCE&gt;]" time="0.025" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[Dosya numaras\u0131: DN-2023-777-&lt;CASE_REFERENCE&gt;]" time="0.011" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_anonymization[\u0631\u0642\u0645 \u0627\u0644\u0642\u0636\u064a\u0629: RQ-2024-333-&lt;CASE_REFERENCE&gt;]" time="0.014" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_language_coverage" time="2.359" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_with_context" time="1.931"><failure message="AssertionError: Should detect email&#10;assert '&lt;EMAIL&gt;' in '\n    Case Management System:\n    - &lt;CASE_REFERENCE&gt;\n    - &lt;CASE_REFERENCE&gt;\n    - Customer Name: &lt;PERSON&gt;\n    - Email: &lt;EMAIL_ADDRESS&gt;\n    - Registration: &lt;LICENSE_PLATE&gt;ter B 123456\n    '">def test_case_reference_with_context():
        """Test CASE_REFERENCE detection in realistic document context."""
        f = PIIFilter()
    
        document = """
        Case Management System:
        - Case ID: CASE-2023-001234
        - Reference Number: REF-2024-567890
        - Customer Name: John Schmidt
        - Email: john.schmidt@example.com
        - Registration: Handelsregister B 123456
        """
    
        out = f.anonymize_text(document)
        assert "&lt;CASE_REFERENCE&gt;" in out, "Should detect case reference in document"
        assert "&lt;PERSON&gt;" in out, "Should also detect person name"
&gt;       assert "&lt;EMAIL&gt;" in out, "Should detect email"
E       AssertionError: Should detect email
E       assert '&lt;EMAIL&gt;' in '\n    Case Management System:\n    - &lt;CASE_REFERENCE&gt;\n    - &lt;CASE_REFERENCE&gt;\n    - Customer Name: &lt;PERSON&gt;\n    - Email: &lt;EMAIL_ADDRESS&gt;\n    - Registration: &lt;LICENSE_PLATE&gt;ter B 123456\n    '

tests\unit\test_regex_patterns.py:347: AssertionError</failure></testcase><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_no_conflict_with_phone" time="1.970" /><testcase classname="tests.unit.test_regex_patterns" name="test_case_reference_no_conflict_with_date" time="2.117" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[BundID: BUND-12345678-ABCD]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Bundidentit\xe4t BUND-87654321-WXYZ]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Bundesausweis-ID: BUND-11111111-1111]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Digital Identity: BUND-99999999-ZYXW]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[ELSTER-ID: ELST-12345]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[ELSTER Login: elster_user_12345]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[ELSTER-Benutzername: user.name@example]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[elster_konto_abcd1234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Servicekonto-ID: SK-2024-001234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Service-Konto: servicekonto_56789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Service Account: SK-2025-009876]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Servicekonto: 123456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_positive[Konto-ID: account_gov_12345]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[Random government text]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[Bundle of sticks]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[Service at the counter]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[ELSTER is a good name]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[123456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_regex_negative[SK SKate]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_anonymization[BundID: BUND-12345678-ABCD-&lt;BUND_ID&gt;]" time="0.012" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_anonymization[ELSTER-ID: ELST-12345-&lt;ELSTER_ID&gt;]" time="0.022" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_anonymization[Servicekonto-ID: SK-2024-001234-&lt;SERVICEKONTO&gt;]" time="0.021" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_anonymization[ELSTER Login: elster_user_12345-&lt;ELSTER_ID&gt;]" time="0.034" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_id_anonymization[Service-Konto: servicekonto_56789-&lt;SERVICEKONTO&gt;]" time="0.032" /><testcase classname="tests.unit.test_regex_patterns" name="test_bundid_variations" time="2.205" /><testcase classname="tests.unit.test_regex_patterns" name="test_elster_variations" time="2.618" /><testcase classname="tests.unit.test_regex_patterns" name="test_servicekonto_variations" time="2.037" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_ids_with_context" time="2.079"><failure message="AssertionError: Should detect email&#10;assert '&lt;EMAIL&gt;' in '\n    Behördliche Registrierung:\n    &lt;BUND_ID&gt;\n    &lt;ELSTER_ID&gt;\n    &lt;SERVICEKONTO&gt;\n    Name: &lt;PERSON&gt;\n    Email: &lt;EMAIL_ADDRESS&gt;\n    '">def test_german_gov_ids_with_context():
        """Test German e-government IDs in realistic document context."""
        f = PIIFilter()
    
        document = """
        Behördliche Registrierung:
        BundID: BUND-12345678-ABCD
        ELSTER-ID: ELST-12345
        Servicekonto: servicekonto_56789
        Name: Max Mustermann
        Email: max@example.com
        """
    
        out = f.anonymize_text(document)
        assert "&lt;BUND_ID&gt;" in out, "Should detect BundID in document"
        assert "&lt;ELSTER_ID&gt;" in out, "Should detect ELSTER_ID in document"
        assert "&lt;SERVICEKONTO&gt;" in out, "Should detect SERVICEKONTO in document"
        assert "&lt;PERSON&gt;" in out, "Should also detect person name"
&gt;       assert "&lt;EMAIL&gt;" in out, "Should detect email"
E       AssertionError: Should detect email
E       assert '&lt;EMAIL&gt;' in '\n    Behördliche Registrierung:\n    &lt;BUND_ID&gt;\n    &lt;ELSTER_ID&gt;\n    &lt;SERVICEKONTO&gt;\n    Name: &lt;PERSON&gt;\n    Email: &lt;EMAIL_ADDRESS&gt;\n    '

tests\unit\test_regex_patterns.py:492: AssertionError</failure></testcase><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_ids_no_false_positives" time="2.094" /><testcase classname="tests.unit.test_regex_patterns" name="test_german_gov_ids_priority" time="2.153"><failure message="AssertionError: Should detect phone&#10;assert '&lt;PHONE&gt;' in '\n    &lt;BUND_ID&gt;\n    Phone: &lt;PHONE_NUMBER&gt;\n    Email: &lt;EMAIL_ADDRESS&gt;\n    &lt;SERVICEKONTO&gt;\n    '">def test_german_gov_ids_priority():
        """Test that German e-government IDs don't conflict with other entities."""
        f = PIIFilter()
    
        # Document with mixed entity types
        document = """
        BundID: BUND-12345678-ABCD
        Phone: +49 30 12345678
        Email: user@example.de
        Service-Konto: servicekonto_xyz789
        """
    
        out = f.anonymize_text(document)
        assert "&lt;BUND_ID&gt;" in out, "Should detect BundID"
        assert "&lt;SERVICEKONTO&gt;" in out, "Should detect SERVICEKONTO"
&gt;       assert "&lt;PHONE&gt;" in out, "Should detect phone"
E       AssertionError: Should detect phone
E       assert '&lt;PHONE&gt;' in '\n    &lt;BUND_ID&gt;\n    Phone: &lt;PHONE_NUMBER&gt;\n    Email: &lt;EMAIL_ADDRESS&gt;\n    &lt;SERVICEKONTO&gt;\n    '

tests\unit\test_regex_patterns.py:530: AssertionError</failure></testcase><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Password: MySecureP@ss2024!]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[pwd: Complex$Pass#123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[User password: AlphaNum3r1c@Secure]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Passwort: SicherP@ssw0rt2024!]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Kennwort: KomplexesK3nnw0rt#GmbH]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Mot de passe: MotDePasse@S\xe9curis\xe92024]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Contrase\xf1a: Contrase\xf1a@Segura2024!]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_positive[Parola: ParolaChiave@Sicura2024!]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[PIN: 1234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[pin-code: 5678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[PIN-number: 9012]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[PIN-Code: 8901]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[Geheimzahl: 2345]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[code-secret: 2222]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[C\xf3digo PIN: 7777]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_positive[Codice PIN: 1111]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[TAN: 654321]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[transaction-authentication-number: 789012]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[Authentifizierungsnummer: 098765]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[num\xe9ro-authentification: 321654]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[N\xfamero TAN: 789123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[Numero TAN: 567891]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_positive[Do\u011frulama TAN: 456789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[PUK: 12345678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[pin-unlock-key: 87654321]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[PUK-code: 55555555]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[Entsperrcode: 98765432]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[PUK-Code: 66666666]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[cl\xe9-d\xe9blocage: 09876543]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[C\xf3digo PUK: 88888888]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_positive[Codice PUK: 99999999]" time="0.003" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[recovery-code: ABC-DEF-123-456]" time="0.002" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[backup-code: XYZ-ABC-789-012]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[Wiederherstellungscode: DEF-GHI-234-567]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[Sicherungscode: BCD-EFG-890-123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[code-de-r\xe9cup\xe9ration: GHI-JKL-345-678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[c\xf3digo-de-recuperaci\xf3n: JKL-MNO-456-789]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_positive[codice-di-recupero: MNO-PQR-567-890]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_negative[RandomP@ssw0rd123]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_negative[MySecret!Passkey]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_negative[12345678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_password_regex_negative[Password alone]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_negative[1234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_negative[5678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_negative[Call me at 1234]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_pin_regex_negative[Version 123456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_negative[654321]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_negative[789012]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_tan_regex_negative[Code 345678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_negative[12345678]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_puk_regex_negative[87654321]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_negative[ABC-DEF-123-456]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_recovery_code_regex_negative[ABCD-EFGH-IJKL]" time="0.001" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_anonymization[Password: MySecureP@ss2024!-&lt;PASSWORD&gt;]" time="0.017" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_anonymization[PIN: 1234-&lt;PIN&gt;]" time="0.010" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_anonymization[TAN: 654321-&lt;TAN&gt;]" time="0.008" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_anonymization[PUK: 12345678-&lt;PUK&gt;]" time="0.024" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_anonymization[recovery-code: ABC-DEF-123-456-&lt;RECOVERY_CODE&gt;]" time="0.020" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_with_context" time="1.953"><failure message="AssertionError: Should also detect email&#10;assert '&lt;EMAIL&gt;' in '\n    User Account Setup:\n    Username: &lt;EMAIL_ADDRESS&gt;\n    &lt;PASSWORD&gt;\n    &lt;PIN&gt;\n    \n    Two-Factor Authentication:\n    &lt;TAN&gt;\n    &lt;PUK&gt;\n    &lt;RECOVERY_CODE&gt;\n    '">def test_auth_secrets_with_context():
        """Test authentication secrets in realistic document context."""
        f = PIIFilter()
    
        document = """
        User Account Setup:
        Username: john.doe@example.com
        Password: SecureP@ssw0rd2024!
        PIN: 1234
    
        Two-Factor Authentication:
        TAN: 654321
        PUK: 12345678
        Recovery code: ABC-DEF-123-456
        """
    
        out = f.anonymize_text(document)
        assert "&lt;PASSWORD&gt;" in out, "Should detect password"
        assert "&lt;PIN&gt;" in out, "Should detect PIN"
        assert "&lt;TAN&gt;" in out, "Should detect TAN"
        assert "&lt;PUK&gt;" in out, "Should detect PUK"
        assert "&lt;RECOVERY_CODE&gt;" in out, "Should detect recovery code"
&gt;       assert "&lt;EMAIL&gt;" in out, "Should also detect email"
E       AssertionError: Should also detect email
E       assert '&lt;EMAIL&gt;' in '\n    User Account Setup:\n    Username: &lt;EMAIL_ADDRESS&gt;\n    &lt;PASSWORD&gt;\n    &lt;PIN&gt;\n    \n    Two-Factor Authentication:\n    &lt;TAN&gt;\n    &lt;PUK&gt;\n    &lt;RECOVERY_CODE&gt;\n    '

tests\unit\test_regex_patterns.py:716: AssertionError</failure></testcase><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_multilingual" time="2.094" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_no_false_positives" time="2.097" /><testcase classname="tests.unit.test_regex_patterns" name="test_auth_secrets_priority" time="2.213"><failure message="AssertionError: Should detect email&#10;assert '&lt;EMAIL&gt;' in '\n    Login Credentials:\n    Email: &lt;EMAIL_ADDRESS&gt;\n    &lt;PASSWORD&gt;\n    &lt;PIN&gt;\n    Phone: &lt;PHONE_NUMBER&gt;\n    \n    &lt;RECOVERY_CODE&gt;:\n    &lt;RECOVERY_CODE&gt;\n    &lt;PUK&gt;\n    '">def test_auth_secrets_priority():
        """Test that authentication secrets don't conflict with other entities."""
        f = PIIFilter()
    
        document = """
        Login Credentials:
        Email: user@example.com
        Password: SecureP@ss@2024!
        PIN: 1234
        Phone: +49 30 12345678
    
        Recovery Information:
        Recovery code: ABC-DEF-123-456
        PUK: 87654321
        """
    
        out = f.anonymize_text(document)
        assert "&lt;PASSWORD&gt;" in out, "Should detect password"
        assert "&lt;PIN&gt;" in out, "Should detect PIN"
        assert "&lt;PUK&gt;" in out, "Should detect PUK"
        assert "&lt;RECOVERY_CODE&gt;" in out, "Should detect recovery code"
&gt;       assert "&lt;EMAIL&gt;" in out, "Should detect email"
E       AssertionError: Should detect email
E       assert '&lt;EMAIL&gt;' in '\n    Login Credentials:\n    Email: &lt;EMAIL_ADDRESS&gt;\n    &lt;PASSWORD&gt;\n    &lt;PIN&gt;\n    Phone: &lt;PHONE_NUMBER&gt;\n    \n    &lt;RECOVERY_CODE&gt;:\n    &lt;RECOVERY_CODE&gt;\n    &lt;PUK&gt;\n    '

tests\unit\test_regex_patterns.py:784: AssertionError</failure></testcase></testsuite></testsuites>